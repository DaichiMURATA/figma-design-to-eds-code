# Vision AI One-Shot Block Generation Prompt

**このプロンプトをCursor Composerにコピー＆ペーストするだけで、ブロック生成が完結します。**

---

## 🚀 使い方

### Cursor Composer (Cmd+I) に以下をコピー＆ペースト：

```
Carouselブロックを生成してください。

# 指示

## 1. Figmaスクリーンショットを取得
以下のコマンドを実行して、Figma Variantのスクリーンショットを取得してください：

```bash
cd /Users/dmurata/Documents/Dev/d2c && npm run capture-figma-variant -- --block=carousel --node-id=9392:204
```

## 2. Figma画像アセットをダウンロード
以下のコマンドを実行して、Figmaから画像アセットをダウンロードしてください：

```bash
cd /Users/dmurata/Documents/Dev/d2c && node scripts/download-figma-assets.js --block=carousel --node-id=9392:204
```

これにより、Figmaの背景画像が `blocks/carousel/carousel-background.png` としてダウンロードされます。

## 3. スクリーンショットを読み込み
取得したスクリーンショット `blocks/carousel/figma-variant-9392-204.png` を読み込んでください。

## 4. ブロックファイルを生成
スクリーンショットを見て、以下のファイルを生成してください：

### 3.1 carousel.css
画像から以下を読み取り、CSSに反映してください：

**背景・レイアウト**:
- フルスクリーン表示（100vh）
- 背景画像は `background-cover` で全体を覆う

**コンテンツパネル**（画像中央の黒い半透明エリア）:
- 背景色: 黒の半透明（透明度を画像から推定）
- 配置: 画面中央（水平・垂直）
- 余白: 左右に大きな余白
- 幅: ビューポートの約60%

**テキスト**:
- 色: 白
- 配置: 中央揃え
- 見出しサイズ: 大きめ（48px前後）
- 本文サイズ: 読みやすいサイズ（18px前後）

**ナビゲーション矢印**（左右の矢印）:
- 背景色: 黒の半透明（透明度を画像から推定）
- アイコン色: 白
- サイズ: 画像から推定
- 形状: 角丸の有無を確認
- 配置: 左右の端、垂直中央

**インジケーター**（下部のドット）:
- 色: 白（アクティブ）、白の半透明（非アクティブ）
- サイズ: 画像から推定
- 間隔: 画像から推定
- 配置: 下部中央

**重要**: 全てのスタイルに `/* 画像から検出: [理由] */` というコメントを付けてください。

### 3.2 carousel.js
EDS Block構造に従って、以下の機能を実装してください：

**基本構造**:
- EDS Blockは Table（Block > Rows > Cells）から生成される
- decorate関数は既存のHTML（table由来）を変換する

**必要な機能**:
- スライドの自動切り替え
- ナビゲーション矢印のクリックイベント
- インジケータードットのクリックイベント
- キーボード操作（左右矢印キー）
- アクセシビリティ対応（ARIA属性）

**参考**: 
- `blocks/hero/hero.js` の構造を参考にする
- `scripts/scripts.js` の共通関数を活用する

### 3.3 carousel.stories.js
Storybook Storyを生成してください：

**重要**: ダウンロードしたFigma画像を使用してください：
- Figma画像パス: `./carousel-background.png`
- このパスを各スライドの `image` プロパティに設定

**必須要素**:
```javascript
import '../../styles/styles.css';
import './carousel.css';
import decorate from './carousel.js';

export default {
  title: 'Blocks/Carousel',
  tags: ['autodocs'],
  parameters: {
    layout: 'fullscreen',
    chromatic: {
      viewports: [375, 1200],
      delay: 500,
    },
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/MJTwyRbE5EVdlci3UIwsut/SandBox-0108-AEM-Figma-Design-Framework?node-id=9392-204',
    },
  },
};

// Template function that creates EDS Block structure
const Template = (args) => {
  const main = document.createElement('main');
  const section = document.createElement('div');
  section.className = 'section carousel-container';
  
  const wrapper = document.createElement('div');
  wrapper.className = 'carousel-wrapper';
  
  const block = createCarouselBlock(args);
  wrapper.appendChild(block);
  section.appendChild(wrapper);
  main.appendChild(section);
  
  decorate(block);
  return main;
};

function createCarouselBlock(args) {
  // EDS Block structure: Block > Rows > Cells
  // Mimics the HTML structure generated by EDS Core Logic (see component-definition.json)
  const block = document.createElement('div');
  block.className = 'carousel';
  block.setAttribute('data-block-name', 'carousel');
  block.setAttribute('data-block-status', 'loaded');
  
  // Create slides from args
  args.slides.forEach((slide) => {
    const row = document.createElement('div'); // Row
    
    // Cell 1: Image (always create, even if empty - EDS structure)
    const imageCell = document.createElement('div'); // Cell
    if (slide.image) {
      // EDS generates picture with source elements
      const picture = document.createElement('picture');
      
      // WebP source
      const sourceWebp = document.createElement('source');
      sourceWebp.type = 'image/webp';
      sourceWebp.srcset = slide.image;
      picture.appendChild(sourceWebp);
      
      // JPEG source
      const sourceJpeg = document.createElement('source');
      sourceJpeg.type = 'image/jpeg';
      sourceJpeg.srcset = slide.image;
      picture.appendChild(sourceJpeg);
      
      // IMG element
      const img = document.createElement('img');
      img.src = slide.image;
      img.alt = slide.alt || '';
      img.loading = 'lazy';
      picture.appendChild(img);
      
      imageCell.appendChild(picture);
    }
    row.appendChild(imageCell);
    
    // Cell 2: Content (always create, even if empty - EDS structure)
    const contentCell = document.createElement('div'); // Cell
    if (slide.heading) {
      const h2 = document.createElement('h2');
      h2.textContent = slide.heading;
      contentCell.appendChild(h2);
    }
    if (slide.text) {
      const p = document.createElement('p');
      p.textContent = slide.text;
      contentCell.appendChild(p);
    }
    row.appendChild(contentCell);
    
    block.appendChild(row);
  });
  
  return block;
}

// Use Figma downloaded images
// Images will be downloaded to blocks/carousel/carousel-background.png
import carouselBg from './carousel-background.png';

// Stories for each Figma Variant (6 variants total)
export const MultipleSlidesContentCenterSmall = {
  render: () => Template({
    slides: [
      { image: carouselBg, heading: 'Lorem ipsum dolor sit amet', text: 'Urna duis convallis convallis tellus id interdum. Faucibus ornare suspendisse sed nisi lacus.' },
      { image: carouselBg, heading: 'Slide 2 Heading', text: 'Slide 2 content text.' },
      { image: carouselBg, heading: 'Slide 3 Heading', text: 'Slide 3 content text.' },
    ],
  }),
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/MJTwyRbE5EVdlci3UIwsut/SandBox-0108-AEM-Figma-Design-Framework?node-id=9392-204',
    },
  },
};

export const MultipleSlidesNoContent = {
  render: () => Template({
    slides: [
      { image: carouselBg },
      { image: carouselBg },
      { image: carouselBg },
    ],
  }),
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/MJTwyRbE5EVdlci3UIwsut/SandBox-0108-AEM-Figma-Design-Framework?node-id=9392-121',
    },
  },
};

export const MultipleSlidesContentRightSmall = {
  render: () => Template({
    slides: [
      { image: carouselBg, heading: 'Lorem ipsum dolor sit amet', text: 'Urna duis convallis convallis tellus id interdum. Faucibus ornare suspendisse sed nisi lacus.' },
      { image: carouselBg, heading: 'Slide 2 Heading', text: 'Slide 2 content text.' },
      { image: carouselBg, heading: 'Slide 3 Heading', text: 'Slide 3 content text.' },
    ],
  }),
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/MJTwyRbE5EVdlci3UIwsut/SandBox-0108-AEM-Figma-Design-Framework?node-id=9392-238',
    },
  },
};

export const MultipleSlidesContentLeftSmall = {
  render: () => Template({
    slides: [
      { image: carouselBg, heading: 'Lorem ipsum dolor sit amet', text: 'Urna duis convallis convallis tellus id interdum. Faucibus ornare suspendisse sed nisi lacus.' },
      { image: carouselBg, heading: 'Slide 2 Heading', text: 'Slide 2 content text.' },
      { image: carouselBg, heading: 'Slide 3 Heading', text: 'Slide 3 content text.' },
    ],
  }),
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/MJTwyRbE5EVdlci3UIwsut/SandBox-0108-AEM-Figma-Design-Framework?node-id=9392-271',
    },
  },
};

export const MultipleSlidesContentCenterFull = {
  render: () => Template({
    slides: [
      { image: carouselBg, heading: 'Lorem ipsum dolor sit amet', text: 'Urna duis convallis convallis tellus id interdum. Faucibus ornare suspendisse sed nisi lacus.' },
      { image: carouselBg, heading: 'Slide 2 Heading', text: 'Slide 2 content text.' },
      { image: carouselBg, heading: 'Slide 3 Heading', text: 'Slide 3 content text.' },
    ],
  }),
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/MJTwyRbE5EVdlci3UIwsut/SandBox-0108-AEM-Figma-Design-Framework?node-id=9392-123',
    },
  },
};

export const SingleSlideCenteredFullContent = {
  render: () => Template({
    slides: [
      { image: carouselBg, heading: 'Lorem ipsum dolor sit amet', text: 'Urna duis convallis convallis tellus id interdum. Faucibus ornare suspendisse sed nisi lacus.' },
    ],
  }),
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/MJTwyRbE5EVdlci3UIwsut/SandBox-0108-AEM-Figma-Design-Framework?node-id=9402-206',
    },
  },
};
```

## 4. 検証を実行
生成後、以下のコマンドを実行して検証してください：

```bash
cd /Users/dmurata/Documents/Dev/d2c && npm run validate-block -- --block=carousel
```

## 5. 結果を報告
以下を報告してください：
- 生成したファイル一覧
- 画像から検出した主要な視覚的詳細（色、サイズ、配置など）
- 検証結果（Visual差異の%）

---

# 重要な注意事項

- **EDS Block構造を厳守**: Block > Rows > Cells の構造を維持
- **既存パターンを参考**: `blocks/hero/` の実装を参考にする
- **画像を正確に読み取る**: 透明度、色、配置、サイズを正確に
- **コメントで根拠を明示**: 「画像から検出」としてコメント追加
- **アクセシビリティ**: ARIA属性、キーボード操作を実装
```

---

## 📝 実行例

Cursor Composer (Cmd+I) を開いて、上記のプロンプトをそのままコピー＆ペーストするだけです。

AIが自動的に：
1. ✅ スクリーンショット取得コマンドを実行
2. ✅ 画像を読み込んで解析
3. ✅ CSS/JS/Stories を生成
4. ✅ 検証コマンドを実行
5. ✅ 結果を報告

---

## 🎯 期待される結果

- **carousel.css**: 視覚的詳細を反映したスタイル（透明度、配置、色など）
- **carousel.js**: 完全に動作するCarouselロジック
- **carousel.stories.js**: Storybook Story
- **検証レポート**: Visual差異 10-15%

---

## 💡 カスタマイズ

### 他のVariantを生成する場合
`--node-id=9392:204` の部分を変更してください：

- `9392:121` - Multiple Slides No Content
- `9392:204` - Multiple Slides Content Center Small
- `9392:238` - Multiple Slides Content Right Small
- `9392:271` - Multiple Slides Content Left Small
- `9392:123` - Multiple Slides Content Center Full
- `9402:206` - Single Slide Centered Full Content

### 他のブロックを生成する場合
`--block=carousel` と `--node-id=...` を変更してください：

```
Heroブロックを生成してください。

# 指示
## 1. Figmaスクリーンショットを取得
```bash
cd /Users/dmurata/Documents/Dev/d2c && npm run capture-figma-variant -- --block=hero --node-id=8668-498
```
...
```

---

## ⚡ さらに簡略化（オプション）

もっと短いプロンプトにしたい場合：

```
Carousel（node-id=9392:204）を生成して。
Figmaスクリーンショットを取得→画像解析→CSS/JS/Stories生成→検証まで全部やって。
```

このシンプルなプロンプトでも、AIが上記の詳細な指示を理解して実行できる可能性があります。
